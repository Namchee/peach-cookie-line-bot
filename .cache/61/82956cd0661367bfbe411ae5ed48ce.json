{"id":"90z3","dependencies":[{"name":"C:\\Users\\Namchee\\Desktop\\peach-bot\\.babelrc","includedInParent":true,"mtime":1563501172477},{"name":"C:\\Users\\Namchee\\Desktop\\peach-bot\\package.json","includedInParent":true,"mtime":1563542599570},{"name":"crypto","loc":{"line":1,"column":19},"parent":"C:\\Users\\Namchee\\Desktop\\peach-bot\\src\\middleware.js","resolved":"C:\\Users\\Namchee\\Desktop\\peach-bot\\node_modules\\crypto-browserify\\index.js"}],"generated":{"js":"\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.checkSignature=t;var e=r(require(\"crypto\"));function r(e){return e&&e.__esModule?e:{default:e}}function t(r,t,s){try{var n=JSON.stringify(r.body);if(e.default.createHmac(\"SHA256\",void 0).update(n).digest(\"base64\")!==r.headers[\"x-line-signature\"])return t.status(401).send(\"Unauthorized\");s()}catch(u){return console.error(u),t.status(500).send(\"Internal server error\")}}"},"sourceMaps":{"js":{"mappings":[{"source":"src/middleware.js","original":{"line":21,"column":1},"generated":{"line":1,"column":0}},{"source":"src/middleware.js","original":{"line":21,"column":1},"generated":{"line":1,"column":13}},{"source":"src/middleware.js","original":{"line":21,"column":1},"generated":{"line":1,"column":20}},{"source":"src/middleware.js","original":{"line":21,"column":1},"generated":{"line":1,"column":35}},{"source":"src/middleware.js","original":{"line":21,"column":1},"generated":{"line":1,"column":43}},{"source":"src/middleware.js","original":{"line":21,"column":1},"generated":{"line":1,"column":56}},{"source":"src/middleware.js","original":{"line":21,"column":1},"generated":{"line":1,"column":57}},{"source":"src/middleware.js","original":{"line":21,"column":1},"generated":{"line":1,"column":64}},{"source":"src/middleware.js","original":{"line":21,"column":1},"generated":{"line":1,"column":68}},{"source":"src/middleware.js","original":{"line":21,"column":1},"generated":{"line":1,"column":76}},{"source":"src/middleware.js","original":{"line":21,"column":1},"generated":{"line":1,"column":91}},{"source":"src/middleware.js","original":{"line":1,"column":0},"generated":{"line":1,"column":93}},{"source":"src/middleware.js","original":{"line":1,"column":0},"generated":{"line":1,"column":97}},{"source":"src/middleware.js","original":{"line":1,"column":0},"generated":{"line":1,"column":99}},{"source":"src/middleware.js","original":{"line":1,"column":0},"generated":{"line":1,"column":101}},{"source":"src/middleware.js","original":{"line":1,"column":0},"generated":{"line":1,"column":109}},{"source":"src/middleware.js","original":{"line":21,"column":1},"generated":{"line":1,"column":120}},{"source":"src/middleware.js","original":{"line":21,"column":1},"generated":{"line":1,"column":129}},{"source":"src/middleware.js","original":{"line":21,"column":1},"generated":{"line":1,"column":131}},{"source":"src/middleware.js","original":{"line":21,"column":1},"generated":{"line":1,"column":134}},{"source":"src/middleware.js","original":{"line":21,"column":1},"generated":{"line":1,"column":141}},{"source":"src/middleware.js","original":{"line":21,"column":1},"generated":{"line":1,"column":144}},{"source":"src/middleware.js","original":{"line":21,"column":1},"generated":{"line":1,"column":146}},{"source":"src/middleware.js","original":{"line":21,"column":1},"generated":{"line":1,"column":157}},{"source":"src/middleware.js","original":{"line":21,"column":1},"generated":{"line":1,"column":159}},{"source":"src/middleware.js","original":{"line":21,"column":1},"generated":{"line":1,"column":160}},{"source":"src/middleware.js","original":{"line":21,"column":1},"generated":{"line":1,"column":168}},{"source":"src/middleware.js","original":{"line":3,"column":7},"generated":{"line":1,"column":171}},{"source":"src/middleware.js","name":"checkSignature","original":{"line":3,"column":16},"generated":{"line":1,"column":180}},{"source":"src/middleware.js","name":"req","original":{"line":3,"column":31},"generated":{"line":1,"column":182}},{"source":"src/middleware.js","name":"res","original":{"line":3,"column":36},"generated":{"line":1,"column":184}},{"source":"src/middleware.js","name":"next","original":{"line":3,"column":41},"generated":{"line":1,"column":186}},{"source":"src/middleware.js","original":{"line":4,"column":6},"generated":{"line":1,"column":189}},{"source":"src/middleware.js","name":"body","original":{"line":5,"column":10},"generated":{"line":1,"column":193}},{"source":"src/middleware.js","name":"body","original":{"line":5,"column":10},"generated":{"line":1,"column":197}},{"source":"src/middleware.js","name":"JSON","original":{"line":5,"column":17},"generated":{"line":1,"column":199}},{"source":"src/middleware.js","name":"stringify","original":{"line":5,"column":22},"generated":{"line":1,"column":204}},{"source":"src/middleware.js","name":"req","original":{"line":5,"column":32},"generated":{"line":1,"column":214}},{"source":"src/middleware.js","name":"body","original":{"line":5,"column":36},"generated":{"line":1,"column":216}},{"source":"src/middleware.js","name":"signature","original":{"line":10,"column":8},"generated":{"line":1,"column":222}},{"source":"src/middleware.js","name":"crypto","original":{"line":7,"column":22},"generated":{"line":1,"column":225}},{"source":"src/middleware.js","name":"createHmac","original":{"line":7,"column":29},"generated":{"line":1,"column":227}},{"source":"src/middleware.js","name":"createHmac","original":{"line":7,"column":29},"generated":{"line":1,"column":235}},{"source":"src/middleware.js","original":{"line":7,"column":40},"generated":{"line":1,"column":246}},{"source":"src/middleware.js","name":"update","original":{"line":8,"column":7},"generated":{"line":1,"column":260}},{"source":"src/middleware.js","name":"update","original":{"line":8,"column":7},"generated":{"line":1,"column":263}},{"source":"src/middleware.js","name":"body","original":{"line":8,"column":14},"generated":{"line":1,"column":270}},{"source":"src/middleware.js","name":"digest","original":{"line":8,"column":20},"generated":{"line":1,"column":273}},{"source":"src/middleware.js","original":{"line":8,"column":27},"generated":{"line":1,"column":280}},{"source":"src/middleware.js","name":"req","original":{"line":10,"column":22},"generated":{"line":1,"column":292}},{"source":"src/middleware.js","name":"headers","original":{"line":10,"column":26},"generated":{"line":1,"column":294}},{"source":"src/middleware.js","original":{"line":10,"column":34},"generated":{"line":1,"column":302}},{"source":"src/middleware.js","name":"res","original":{"line":11,"column":13},"generated":{"line":1,"column":322}},{"source":"src/middleware.js","name":"res","original":{"line":11,"column":13},"generated":{"line":1,"column":329}},{"source":"src/middleware.js","name":"status","original":{"line":11,"column":17},"generated":{"line":1,"column":331}},{"source":"src/middleware.js","original":{"line":11,"column":24},"generated":{"line":1,"column":338}},{"source":"src/middleware.js","name":"send","original":{"line":12,"column":9},"generated":{"line":1,"column":343}},{"source":"src/middleware.js","original":{"line":12,"column":14},"generated":{"line":1,"column":348}},{"source":"src/middleware.js","name":"next","original":{"line":15,"column":4},"generated":{"line":1,"column":364}},{"source":"src/middleware.js","original":{"line":16,"column":4},"generated":{"line":1,"column":368}},{"source":"src/middleware.js","name":"err","original":{"line":16,"column":11},"generated":{"line":1,"column":374}},{"source":"src/middleware.js","name":"res","original":{"line":19,"column":11},"generated":{"line":1,"column":377}},{"source":"src/middleware.js","name":"console","original":{"line":17,"column":4},"generated":{"line":1,"column":384}},{"source":"src/middleware.js","name":"error","original":{"line":17,"column":12},"generated":{"line":1,"column":392}},{"source":"src/middleware.js","name":"err","original":{"line":17,"column":18},"generated":{"line":1,"column":398}},{"source":"src/middleware.js","name":"res","original":{"line":19,"column":11},"generated":{"line":1,"column":401}},{"source":"src/middleware.js","name":"status","original":{"line":19,"column":15},"generated":{"line":1,"column":403}},{"source":"src/middleware.js","original":{"line":19,"column":22},"generated":{"line":1,"column":410}},{"source":"src/middleware.js","name":"send","original":{"line":19,"column":27},"generated":{"line":1,"column":415}},{"source":"src/middleware.js","original":{"line":19,"column":32},"generated":{"line":1,"column":420}}],"sources":{"src/middleware.js":"import crypto from 'crypto';\r\n\r\nexport function checkSignature(req, res, next) {\r\n  try {\r\n    const body = JSON.stringify(req.body);\r\n\r\n    const signature = crypto.createHmac('SHA256', process.env.CHANNEL_SECRET)\r\n      .update(body).digest('base64');\r\n\r\n    if (signature !== req.headers['x-line-signature']) {\r\n      return res.status(401)\r\n        .send('Unauthorized');\r\n    }\r\n\r\n    next();\r\n  } catch (err) {\r\n    console.error(err);\r\n\r\n    return res.status(500).send('Internal server error');\r\n  }\r\n}\r\n"},"lineCount":null}},"error":null,"hash":"b9fa4bce8bb54cbb2ef7ae5ee79b149a","cacheData":{"env":{}}}